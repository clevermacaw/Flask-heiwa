openapi: 3.0.1
info:
  description: A forum API.
  title: Heiwa
  version: 0.13.44
paths:
  /forums:
    get:
      description: "Returns a list of forums that the current user has access to,
      and matches the filter if there is one requested."
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - limit
              properties:
                limit:
                  allOf:
                    - $ref: "#/components/schemas/Limit"
                offset:
                  allOf:
                    - $ref: "#/components/schemas/Offset"
                filter:
                  allOf:
                    - $ref: "#/components/schemas/Filter"
                  properties:
                    "$eq":
                      type: object
                      minProperties: 1
                      maxProperties: 1
                      properties:
                        id:
                          allOf:
                            - $ref: "#/components/schemas/Forum/properties/id"
      responses:
        200:
          description: The list of forums.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Forum"

components:
  schemas:
    User:
      type: object
      properties:
        id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: This user\'s ID.
        creation_timestamp:
          allOf:
            - $ref: "#/components/schemas/CreationTimestamp"
          description: The time this user registered.
        edit_timestamp:
          allOf:
            - $ref: "#/components/schemas/EditTimestamp"
          description: The last time this user was edited.
        edit_count:
          allOf:
            - $ref: "#/components/schemas/EditCount"
          description: How many times this user was edited.
        registered_by:
          type: string
          minLength: 1
          maxLength: 128
          nullable: true
          readOnly: true
          description: "The service this user was registered by.
          Only visible to them."
        external_id:
          type: string
          minLength: 1
          maxLength: 64
          nullable: true
          readOnly: true
          description: "This user's ID on the service they were registered by.
          Only visible to them."
        avatar_type:
          type: string
          minLength: 3
          maxLength: 256
          nullable: true
          readOnly: true
          description: The MIME type of this user\'s avatar.
        is_banned:
          type: boolean
          description: Whether or not this user is banned.
        parsed_permissions:
          allOf:
            - $ref: "#/components/schemas/Permissions"
          description: This user\'s parsed permissions.
        encrypted_private_key:
          type: string
          format: base64
          nullable: true
          description: "This user's encrypted private key.
          Only visible to them."
        public_key:
          type: string
          format: base64
          description: This user\'s public key.
        name:
          type: string
          minLength: 1
          maxLength: 128
          nullable: true
          description: This user\'s name.
        status:
          type: string
          minLength: 1
          maxLength: 65535
          nullable: true
          description: This user\'s status.
        followee_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: How many users this user has followed.
        follower_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: How many users have followed this user.
        forum_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: How many forums this user has created.
        message_received_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: "How many messages this user has received in total.
          Only visible to them."
        message_received_unread_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: "How many messages this user has received and not yet read.
          Only visible to them."
        message_sent_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: "How many messages this user has sent.
          Only visible to them."
        notification_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: "How many notifications this user has.
          Only visible to them."
        notification_unread_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: "How many unread notifications this user has.
          Only visible to them."
        post_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: How many posts this user has created.
        thread_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: How many threads tihs user has created.
      description: A user.
    Group:
      type: object
      properties:
        id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: This group\'s ID.
        creation_timestamp:
          allOf:
            - $ref: "#/components/schemas/CreationTimestamp"
          description: The time this group was created.
        edit_timestamp:
          allOf:
            - $ref: "#/components/schemas/EditTimestamp"
          description: The last time this group was edited.
        edit_count:
          allOf:
            - $ref: "#/components/schemas/EditCount"
          description: How many times this group was edited.
        default_for:
          type: array
          items:
            type: string
            minLength: 1
            maxLength: 128
            description: A registration service, or \'*\'.
          description: "The registration services that users who are
          automatically assigned this group should have."
        name:
          type: string
          minLength: 1
          maxLength: 128
          description: This group\'s name.
        description:
          type: string
          minLength: 1
          maxLength: 65536
          description: This group\'s description.
      description: A group.
    Forum:
      type: object
      properties:
        id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The forum\'s ID.
        creation_timestamp:
          allOf:
            - $ref: "#/components/schemas/CreationTimestamp"
          description: The time this forum was created.
        edit_timestamp:
          allOf:
            - $ref: "#/components/schemas/EditTimestamp"
          description: The last time forum was edited.
        edit_count:
          allOf:
            - $ref: "#/components/schemas/EditCount"
          description: How many times this forum was edited.
        parent_forum_id:
          allOf:
            - $ref: "#/components/schemas/Id"
          nullable: true
          description: The ID of this forum\'s parent.
        user_id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The ID of this forum\'s author.
        name:
          type: string
          minLength: 1
          maxLength: 128
          description: This forum\'s name.
        description:
          type: string
          minLength: 1
          maxLength: 65536
          nullable: true
          description: This forum\'s description.
        subscriber_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: How many users have subscribed to this forum.
        thread_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: How many threads are in this forum (excluding child forums).
        last_thread_timestamp:
          allOf:
            - $ref: "#/components/schemas/Timestamp"
          nullable: true
          description: When the last thread in this forum was created.
      description: A forum.
    Thread:
      type: object
      properties:
        id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The thread\'s ID.
        creation_timestamp:
          allOf:
            - $ref: "#/components/schemas/CreationTimestamp"
          description: The time this thread was created.
        edit_timestamp:
          allOf:
            - $ref: "#/components/schemas/EditTimestamp"
          description: The last time thread was edited.
        edit_count:
          allOf:
            - $ref: "#/components/schemas/EditCount"
          description: How many times this thread was edited.
        forum_id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The ID of the forum this thread is in.
        user_id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The ID of this thread\'s author.
        is_locked:
          type: boolean
          description: Whether or not this thread is locked.
        is_pinned:
          type: boolean
          description: Whether or not this thread is pinned.
        tags:
          type: array
          items:
            type: string
            minLength: 1
            maxLength: 128
          description: This thread\'s tags.
        name:
          type: string
          minLength: 1
          maxLength: 128
          description: This thread\'s name.
        content:
          type: string
          minLength: 1
          maxLength: 128
          description: This thread\'s content.
        vote_value:
          allOf:
            - $ref: "#/components/schemas/VoteValue"
          description: The computed value of this thread\'s votes.
        post_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: How many posts are in this thread.
        subscriber_count:
          allOf:
            - $ref: "#/components/schemas/Count"
          description: How many users have subscribed to this thread.
        last_post_timestamp:
          allOf:
            - $ref: "#/components/schemas/Timestamp"
          nullable: true
          description: When the last post in this thread was created.
      description: A thread.
    Post:
      type: object
      properties:
        id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The post\'s ID.
        creation_timestamp:
          allOf:
            - $ref: "#/components/schemas/CreationTimestamp"
          description: The time this post was created.
        edit_timestamp:
          allOf:
            - $ref: "#/components/schemas/EditTimestamp"
          description: The last time post was edited.
        edit_count:
          allOf:
            - $ref: "#/components/schemas/EditCount"
          description: How many times this post was edited.
        thread_id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The ID of the thread this post is in.
        user_id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The ID of this post\'s author.
        content:
          type: string
          minLength: 1
          maxLength: 262144
          description: This post\'s content.
        vote_value:
          allOf:
            - $ref: "#/components/schemas/VoteValue"
          description: The computed value of this post\'s votes.
      description: A post.
    Message:
      type: object
      properties:
        id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The message\'s ID.
        creation_timestamp:
          allOf:
            - $ref: "#/components/schemas/CreationTimestamp"
          description: The time this message was created.
        edit_timestamp:
          allOf:
            - $ref: "#/components/schemas/EditTimestamp"
          description: The last time message was edited.
        edit_count:
          allOf:
            - $ref: "#/components/schemas/EditCount"
          description: How many times this message was edited.
        sender_id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The ID of this message\'s sender.
        receiver_id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The ID of this receiver\'s sender.
        is_read:
          type: boolean
          description: Whether or not this message has been read.
        encrypted_session_key:
          type: string
          format: base64
          description: "This message's session key, encrypted with the
          receiver's public RSA key."
        tag:
          type: string
          format: base64
          nullable: true
          description: "This message's tag, derived from the decrypted
          content to detect modifications."
        encrypted_content:
          type: string
          format: base64
          description: This message\'s encrypted content.
      description: A message.
    Notification:
      type: object
      properties:
        id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The notification\'s ID.
        creation_timestamp:
          allOf:
            - $ref: "#/components/schemas/CreationTimestamp"
          description: The time this notification was created.
        user_id:
          allOf:
            - $ref: "#/components/schemas/Id"
          description: The ID of this notification\'s owner.
        is_read:
          type: boolean
          description: Whether or not this notification has been read.
        type:
          type: string
          enum:
            - NewPostFromFollowee
            - NewPostInSubscribedThread
            - NewThreadFromFollowee
            - NewThreadInSubscribedForum
            - ForumChangedOwnership
          readOnly: true
          description: The type of this notification.
        identifier:
          type: string
          format: uuid
          readOnly: true
          description: "The identifier of this notification's subject.
          (For example, with a new thread notification, the thread's ID)"
      description: A notification.
    Filter:
      type: object
      properties:
        "$and":
          type: array
          items:
            $ref: "#/components/schemas/Filter"
        "$or":
          type: array
          items:
            $ref: "#/components/schemas/Filter"
        "$not":
          allOf:
            - $ref: "#/components/schemas/Filter"
    Permissions:
      type: object
      properties:
        forum_create:
          type: boolean
          description: Whether or not a user can create forums.
        forum_delete_own:
          type: boolean
          description: Whether or not a user can delete their own forums.
        forum_delete_any:
          type: boolean
          description: Whether or not a user can delete any forum.
        forum_edit_own:
          type: boolean
          description: Whether or not a user can edit their own forums.
        forum_edit_any:
          type: boolean
          description: Whether or not a user can edit any forum.
        forum_merge_own:
          type: boolean
          description: "Whether or not a user can merge their own forums
          with other forums they've created."
        forum_merge_any:
          type: boolean
          description: Whether or not a user can merge any forum with any forum.
        forum_move_own:
          type: boolean
          description: "Whether or not a user can move their forums to other
          forums they've created."
        forum_move_any:
          type: boolean
          description: Whether or not a user can move any forum to any forum.
        forum_view:
          type: boolean
          description: Whether or not a user can view forums.
        group_create:
          type: boolean
          description: Whether or not a user can create groups.
        group_delete:
          type: boolean
          description: Whether or not a user can delete groups.
        group_edit:
          type: boolean
          description: Whether or not a user can edit groups.
        group_edit_permissions:
          type: boolean
          description: Whether or not a user can edit groups' permissions.
        post_create:
          type: boolean
          description: Whether or not a user can create posts.
        post_delete_own:
          type: boolean
          description: Whether or not a user can delete their own posts.
        post_delete_any:
          type: boolean
          description: Whether or not a user can delete any post.
        post_edit_own:
          type: boolean
          description: Whether or not a user can edit their own posts.
        post_edit_any:
          type: boolean
          description: Whether or not a user can edit any post.
        post_edit_vote:
          type: boolean
          description: Whether or not a user can vote on posts.
        post_move_own:
          type: boolean
          description: "Whether or not a user can move their own posts to their
          own threads."
        post_move_any:
          type: boolean
          description: Whether or not a user can move any post to any thread.
        post_view:
          type: boolean
          description: Whether or not a user can view posts.
        thread_create:
          type: boolean
          description: Whether or not a user can create threads.
        thread_delete_own:
          type: boolean
          description: Whether or not a user can delete their own threads.
        thread_delete_any:
          type: boolean
          description: Whether or not a user can delete any thread.
        thread_edit_own:
          type: boolean
          description: Whether or not a user can edit their own threads.
        thread_edit_any:
          type: boolean
          description: Whether or not a user can edit any thread.
        thread_edit_lock_own:
          type: boolean
          description: Whether or not a user can lock their own threads.
        thread_edit_lock_any:
          type: boolean
          description: Whether or not a user can lock any thread.
        thread_edit_pin:
          type: boolean
          description: Whether or not a user can pin threads.
        thread_edit_vote:
          type: boolean
          description: Whether or not a user can vote on threads.
        thread_merge_own:
          type: boolean
          description: "Whether or not a user can merge their own threads with
          other threads they've created."
        thread_merge_any:
          type: boolean
          description: Whether or not a user can merge any thread with any thread.
        thread_move_own:
          type: boolean
          description: "Whether or not a user can move their own threads to
          forums they've created."
        thread_move_any:
          type: boolean
          description: Whether or not a user can move any thread to any forum.
        thread_view:
          type: boolean
          description: Whether or not a user can view threads.
        user_delete:
          type: boolean
          description: Whether or not a user can delete other users.
        user_edit_ban:
          type: boolean
          description: Whether or not a user can ban other users.
        user_edit_groups:
          type: boolean
          description: Whether or not a user can modify other users' groups.
        user_edit_permissions:
          type: boolean
          description: Whether or not a user can modify other users' permissions.
      description: Permissions.
    Id:
      type: string
      format: uuid
      readOnly: true
      description: An object\'s ID, in the form of an UUID4.
    Timestamp:
      type: string
      format: date-time
      description: A timestamp.
    CreationTimestamp:
      allOf:
        - $ref: "#/components/schemas/Timestamp"
      readOnly: true
      description: The time an object was created.
    EditTimestamp:
      allOf:
        - $ref: "#/components/schemas/Timestamp"
      nullable: true
      readOnly: true
      description: The time an object was last edited.
    Count:
      type: integer
      minimum: 0
      maximum: 2147483647
      readOnly: true
      description: A counter.
    EditCount:
      allOf:
        - $ref: "#/components/schemas/Count"
      readOnly: true
      description: The amount of times an object was edited.
    VoteValue:
      type: integer
      minimum: -2147483647
      maximum: 2147483647
      readOnly: true
      description: The computed value of an object\'s votes.
    Offset:
      type: integer
      minimum: 0
      maximum: 0
      default: 0
      description: How many results to skip. Useful for pagination.
    Limit:
      type: integer
      minimum: 1
      maximum: 512
      description: How many results to look for.
